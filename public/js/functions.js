let isIos=/iPhone|iPad|iPod/i.test(navigator.userAgent);tapEvent="ontouchstart"in window&&!isIos?"tap":"click",breakpoints={},["SM","MD","LG","XL","XXL"].forEach(function(e){var t=parseInt($(":root").css("--breakpoint-"+e.toLowerCase()));window["breakpoint"+e]=t,breakpoints[e.toLowerCase()]=t}),getCurrentBreakPoint=function(e){let i=["xs","sm","md","lg","xl","xxl"],l=$(window).width(),a;return i.forEach(function(e,t){var n=breakpoints[e]||0,t=breakpoints[i[t+1]]||null;if(l>=n&&(null==t||l<t))return a=e,!1}),e&&"object"==typeof e&&e[a]||a},window.thisDevice="desktop",/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)&&(window.thisDevice="mobile"),tapEventInfo=function(e,t){var n,i,l,a="",e="mobile"!=thisDevice||isIos?(i=e.target.attributes||!1,e.target.className||!1):(i=null!=e.changedTouches&&e.changedTouches[0].target.attributes,null!=e.changedTouches&&e.changedTouches[0].target.className);return i.length&&$.each(i,function(e,t){a+=" "+t.name}),n={classes:!(!e||"string"!=typeof e)&&e.split(" "),attributes:!(!a||"string"!=typeof a)&&a.trim().split(" ")},null!=t&&t.class?!!n.classes&&(l=!1,"object"==typeof t.class?($.each(t.class,function(e,t){-1!=n.classes.indexOf(t)&&(l=!0)}),l):-1!=n.classes.indexOf(t.class)):null!=t&&t.attribute?!!n.attributes&&(l=!1,"object"==typeof t.attribute?($.each(t.attribute,function(e,t){-1!=n.attributes.indexOf(t)&&(l=!0)}),l):-1!=n.attributes.indexOf(t.attribute)):!(!n.classes&&!n.attributes)&&n},$.fn.replaceTag=function(t){let a=$(this);for(;0<a.length;a++){let e=$(a[0]).html(),l="";for(let e,t=0,n=a[0].attributes,i=n.length;t<i;t++)e=n[t],l+=" "+e.nodeName+'="'+e.nodeValue+'"';$(a[0]).replaceWith("<"+t+l+">"+e+"</"+t+">")}},pageReload=function(){location.reload(),location.reload(),window.location.reload(),window.location.reload(),window.location.reload(),window.location.reload(),self.location.reload(),self.location.reload(),self.location.reload(),self.location.reload(),window.location=window.location},$.fn.imgLoaded=function(e){var t=new Image,n=$(this).attr("src");t.onload=function(){"function"==typeof e&&e()},t.src=n},Counter=function(e,t,n){var i=e||0;return function(e){return i=null!=e?e:i,null!=t&&"+"!=t||"-"==t?i-=n:i+=n}},searchInObject=function(e,n,i){return e.findIndex(function(e,t){if(e[n]==i)return t})},isJson=function(e){if(null==e||void 0===e)return!1;try{JSON.parse(e)}catch(e){return!1}return!0},isInt=function(e){return null!=e&&void 0!==e&&("string"!=typeof e?Number(e)===e&&e%1==0:Number(e)+""===e)},isFloat=function(e){return null!=e&&void 0!==e&&("string"!=typeof e?Number(e)===e&&e%1!=0:Number(e)+""===e&&Number(e)%1!=0)},count=function(e){var t=e.length;return null!=t?t:Object.values(e).length},hasIn=function(e,t,n){var i;return null!=t&&null!=e&&0!=e.length&&(null!=n&&1==n?-1!=(i=(n=Object.keys(e)).indexOf(t))&&e[n[i]]:-1!=(i=e.indexOf(t))&&i)},getFileName=function(e,t,n){var e=e.split("."),i=e.pop(),e=e.join(".");return null==t||1==t?(null!=n&&isInt(n)&&e.length>n?e.substr(0,n):e)||i:2==t?i:void 0},$.fn.disableDrop=function(l,a){function t(e,t){if(l&&"function"!=typeof l){var n=!1;if("object"==typeof l)for(var i=0;i<l.length;i++)0!=$(e.target).hasClass(l[i])&&(n=!0);else 0!=$(e.target).hasClass(l)&&(n=!0);n||(e.preventDefault(),t&&a&&"function"==typeof a&&a(e.target))}else e.preventDefault(),t&&l&&"function"==typeof l&&l(e.target)}$(this).off(tapEvent).on(tapEvent,function(e){t(e,!0)}),$(this).off("dragover").on("dragover",function(e){t(e)}),$(this).off("dragleave").on("dragleave",function(e){t(e)}),$(this).off("drop").on("drop",function(e){t(e,!0)})},$.fn.setAttrib=function(e,t){return null!=e&&0!=$(this).length&&($(this).attr(e,t||""),void $(this)[0].setAttribute(e,t||""))},$.fn.removeAttrib=function(e){return null!=e&&0!=$(this).length&&($(this).prop(e,!1),$(this).removeAttr(e),void $(this)[0].removeAttribute(e))},$.fn.hasAttr=function(e){e=$(this).attr(e);return void 0!==e&&!1!==e},disableScroll=function(){var e=[self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop];$("html").setAttrib("scroll-position",e.join("|")),$("html").setAttrib("previous-overflow",$("html").css("overflow")),$("html").css("overflow","hidden"),window.scrollTo(e[0],e[1])},enableScroll=function(){var e=$("html").attr("scroll-position");e&&(e=e.split("|"),$("html").css("overflow",$("html").attr("previous-overflow")),$("html").removeAttrib("scroll-position"),$("html").removeAttrib("previous-overflow"),$("html").removeAttrib("style"),window.scrollTo(e[0],e[1]))},$.fn.errorLabel=function(e){var t=".field, .textarea, .select, .file, .ddrselect";(0==$(this).closest(t).length?(0<$(this).siblings("span.error").length?$(this).siblings("span.error").html(e):$(this).after('<span class="error">'+e+"</span>"),$(this)):(0==$(this).closest(t).find("span.error").length?$(this).closest(t).append('<span class="error">'+e+"</span>"):$(this).closest(t).find("span.error").html(e),$(this).closest(t))).addClass("error")},$.fn.scrollFix=function(e){var t,n=this,i=$.extend({cls:"fixed",pos:200},e),l=$(window).scrollTop();l>i.pos&&!$(n).hasClass(i.cls)?$(n).addClass(i.cls):l<=i.pos&&$(n).hasClass(i.cls)&&$(n).removeClass(i.cls),$(window).scroll(function(e){clearTimeout(t),t=setTimeout(function(){(l=$(window).scrollTop())>i.pos&&!$(n).hasClass(i.cls)?$(n).addClass(i.cls):l<=i.pos&&$(n).hasClass(i.cls)&&$(n).removeClass(i.cls)},10)})},random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},generateCode=function(e){for(var t=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n="",i=0;i<e.length;i++)"l"==e.substr(i,1)?n+=t[random(0,25)]:"L"==e.substr(i,1)?n+=t[random(0,25)].toUpperCase():"n"==e.substr(i,1)&&(n+=random(0,9));return n},getContenteditable=function(e){let t=$(e).html(),n=document.createElement("div");return""!=t&&(t=t.replace(/<br><br>/gu,"\n").replace(/<div><br><\/div>/gu,"\n").replace(/<br>/gu,"\n").replace(/<div>/gu,"\n").replace(/<\/div>/gu,"").replace(/&nbsp;/gu,""),n.innerHTML=t,(n.textContent||n.innerText).trim())||""},getArgs=function(e){var n,t=location.search.substr(1,location.search.length).split("&"),i={};return $.each(t,function(e,t){if(""==t)return!0;n=t.split("="),i[n[0]]=n[1]}),null!=e&&null!=i[e]?i[e]:(null==e||null!=i[e])&&(0<Object.keys(i).length?i:null)},urlExists=function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!=t.status},showError=function(e){var t,n=generateCode("lLLnnn");e.responseText&&(t="<div>"+e.responseText+"</div>",t=0<$(t).find("#container").length?'<div class="show_error"><div>'+$(t).find("#container").html()+'</div><button id="'+n+'">Закрыть</button></div>':'<div class="show_error"><div>'+e.responseText+'</div><button id="'+n+'">Закрыть</button></div>',$("body").append(t),$("#"+n).on(tapEvent,function(){$(this).parent(".show_error").remove()}))},getAjaxHtml=function(){var e=arguments,t="string"==typeof e[0]&&("/"!=e[0].substr(0,1)&&"http://"!=e[0].substr(0,7)&&"https://"!=e[0].substr(0,7)?"/"+e[0]:e[0]);if(!t)throw new Error("getAjaxHtml Ошибка! не передан URL");var n="object"==typeof e[1]&&e[1];let i=n||"function"!=typeof e[1]?void 0!==e[2]&&"function"==typeof e[2]&&e[2]:e[1],l="function"==typeof e[1]&&"function"==typeof e[2]?e[2]:"function"==typeof e[2]&&"function"==typeof e[3]&&e[3];$.ajax({url:t,method:"POST",data:n,dataType:"html",success:function(e){(e=e.trim())&&i?i(e,!0):i&&i('<p class="empty center">Нет данных</p>',!1)},error:function(e){notify("Системная ошибка!","error"),showError(e)},complete:function(){l&&l()}})},getSectionData=function(t,n){if(null==t)return!1;var e=t.data||{};e.json=1,t.section&&(e.section=t.section),t.template&&(e.template=t.template),$.ajax({url:location.href,method:"POST",data:e,dataType:t.template?"html":"json",success:function(e){t.template?(html=e.trim())&&n?n(html,!0):n&&n('<p class="empty center">Нет данных</p>',!1):n(e)},error:function(e){notify("Системная ошибка!","error"),showError(e),n(!1)}})},$.fn.changeInputs=function(n){var i;return 0==this.length?(console.warn("changeInputs ошибка! Селектор: не найден!"),!1):null==n||"function"!=typeof n?(console.warn("changeInputs ошибка! callback функция не задана!"),!1):($(this).on("change",'select, input[type="checkbox"], input[type="radio"], input[type="color"], input[type="number"], input[type="date"]',function(e){a(this,l(e))}),void $(this).on("keyup keydown","input, textarea, [contenteditable]",function(e){var t,n=this,e=l(e);-1==["text","password","email","tel","number"].indexOf(e.st)&&("textarea"!=e.s||e.codeShift||e.codeCtrl)&&"contenteditable"!=e.st||("keydown"==e.t?i="contenteditable"==e.st?$(n).html():$(n).val():"keyup"==e.t&&(t="contenteditable"==e.st?$(n).html():$(n).val(),i!==t||"contenteditable"==e.st&&e.codeEnter)&&(i=t,a(n,e)))}));function l(e){return{t:e.type,k:e.keyCode,s:e.currentTarget.localName,st:null==e.currentTarget.type?"contenteditable":"select-one"==e.currentTarget.type?e.currentTarget.type.replace("select-one","select"):e.currentTarget.type,isShiftKey:e.shiftKey,isCtrlKey:e.ctrlKey,codeShift:16==e.keyCode,codeCtrl:17==e.keyCode,codeEnter:13==e.keyCode,codeX:88==e.keyCode,codeV:86==e.keyCode}}function a(e,t){n(e,t)}},initEditors=function(){var t=!1,e=[],n=[];for(i=0;i<100;i++)e.push(""+i),n.push(i+"px");options={disableDragAndDrop:!0,height:500,lang:"en-US",emptyPara:"",lineHeights:n,fontSizes:e,codeviewFilter:!1,codeviewIframeFilter:!0,disableGrammar:!0,codemirror:{theme:"monokai"},toolbar:[["font",["bold","italic","underline","clear"]],["height",["height"]],["style",["style"]],["fontsize",["fontsize"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","image","video"]],["view",["fullscreen","codeview"]]],callbacks:{onChange:function(e){$(this).closest("tr").find("[save], [update]").length&&$(this).closest("tr").find("[save], [update]").removeAttrib("disabled")}},buttons:{image:function(n){return $.summernote.ui.button({contents:'<i class="note-icon-picture"></i>',tooltip:"Добавить картинку",className:"editorfile",click:function(){let e=["#clientFileManagerSN","[filemanager]",".editorfile"];$("#clientFileManagerSN:not(.visible)").addClass("visible"),(currentDir=lscache.get("clientmanagerdir")||!1)&&!t&&(getAjaxHtml("filemanager/files_get",{directory:currentDir,filetypes:"png|jpg|jpeg|gif|ico|bmp|svg",client:1},function(e){$("#clientFileManagerSN").find("#clientFilemanagerContentFiles").html(e)}),getAjaxHtml("filemanager/dirs_get",{current_dir:currentDir},function(e){$("#clientFileManagerSN").find("#clientFilemanagerDirs").html(e)}),t=!0),$("#clientFileManagerSN").find("#clientFilemanagerContentFiles").off(tapEvent,".image").on(tapEvent,".image",function(){var e=$(this).closest(".clientfilemanager__file"),t=$(e).attr("dirfile");$(e).attr("namefile"),$(this).find("img").attr("src");n.invoke("editor.insertImage",location.origin+"/public/filemanager/"+t),$("#clientFileManagerSN").removeClass("visible")}),$("#clientFileManagerSN").find("#clientFilemanagerDirs").off(tapEvent,"[directory]:not(.disabled):not(.active)").on(tapEvent,"[directory]:not(.disabled):not(.active)",function(){var e=$(this).attr("directory");lscache.set("clientmanagerdir",e),$("#clientFileManagerSN").find("#clientFilemanagerDirs").find("[directory]").removeClass("active"),$(this).addClass("active"),$("#clientFileManagerSN").find("#clientFilemanagerContentFiles").addClass(" clientfilemanager__files_loading"),getAjaxHtml("filemanager/files_get",{directory:e,filetypes:"png|jpg|jpeg|gif|ico|bmp|svg",client:1},function(e,t){$("#clientFileManagerSN").find("#clientFilemanagerContentFiles").html(e),$("#clientFileManagerSN").find("#clientFilemanagerContentFiles").removeClass("clientfilemanager__files_loading")})}),$("body").on(tapEvent,function(){0==$(e.join(":hover, ")+":hover").length&&$("#clientFileManagerSN").hasClass("visible")&&$("#clientFileManagerSN").removeClass("visible")}),$("#clientFileManagerSN").on("mouseenter",function(){disableScroll()}),$("#clientFileManagerSN").on("mouseleave",function(){enableScroll()})}}).render()}}},$("body").find("[editor]:not(.activated)").summernote(options),$("body").find("[editor]").addClass("activated")},ddrInitTabs=function(){var e=location.hash.substr(1,location.hash.length).split("."),t=e[0];(null!=e[1]?($("#"+t).find(".tabstitles:not(.sub) li").removeClass("active"),$("#"+t).find(".tabstitles:not(.sub) li#"+e[1]).addClass("active"),$("#"+t).find(".tabstitles:not(.sub)").siblings(".tabscontent").find("[tabid]").removeClass("visible"),$("#"+t).find(".tabstitles:not(.sub)").siblings(".tabscontent").find('[tabid="'+e[1]+'"]')):($("#"+t).find(".tabstitles:not(.sub) li:first").addClass("active"),$("#"+t).find(".tabstitles:not(.sub)").siblings(".tabscontent").find("[tabid]:first"))).addClass("visible"),null!=e[2]?0<$("#"+t).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").length&&$("#"+t).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").each(function(){(0<$(this).children("li#"+e[2]).length?($(this).children("li").removeClass("active"),$(this).children("li#"+e[2]).addClass("active"),$(this).siblings(".tabscontent").find("[tabid]").removeClass("visible"),$(this).siblings(".tabscontent").find('[tabid="'+e[2]+'"]')):($(this).children("li:first").addClass("active"),$(this).siblings(".tabscontent").find("[tabid]:first"))).addClass("visible")}):0<$("#"+t).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").length&&$("#"+t).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").each(function(){$(this).children("li").removeClass("active"),$(this).children("li:first").addClass("active"),$(this).siblings(".tabscontent").find("[tabid]").removeClass("visible"),$(this).siblings(".tabscontent").find("[tabid]:first").addClass("visible")})},clientFileManager=function(e){var i,t,n="",l=!1,a=!1,o={all:"png|jpg|jpeg|gif|ico|bmp|mp4|avi|mov|wmv|mpeg|3gp|flv|m4v|mpg|swf|mp3|wav|wma|m3u|ogg|wav|wave|doc|docx|pdf|ppt|pptx|rtf|xls|xlsx|txt|glb|gltf|obj",images:"png|jpg|jpeg|gif|ico|bmp",threed:"glb|gltf|obj",videos:"mp4|avi|mov|wmv|mpeg|3gp|flv|m4v|mpg|swf",audios:"mp3|wav|wma|m3u|ogg|wav|wave",docs:"doc|docx|pdf|ppt|pptx|rtf|xls|xlsx|txt"},s=["#clientFileManager","[filemanager]",".editorfile"],r=$.extend({onOpenFilemanager:!1,onRemoveFile:!1,onChooseFile:!1},e);0==$("#clientFileManager").length&&(n+='<div class="clientfilemanager" id="clientFileManager"><div class="clientfilemanager__dirs mb-2"><ul class="noselect" id="clientFilemanagerDirs"></ul></div><div class="clientfilemanager__files noselect" id="clientFilemanagerContentFiles"><p class="empty center">Выберите раздел</p></div></div>',$("body").append(n)),0==$("#clientFileManagerSN").length&&(n+='<div class="clientfilemanager" id="clientFileManagerSN"><div class="clientfilemanager__dirs mb-2"><ul class="noselect" id="clientFilemanagerDirs"></ul></div><div class="clientfilemanager__files noselect" id="clientFilemanagerContentFiles"><p class="empty center">Выберите раздел</p></div></div>',$("body").append(n)),$("body").off(tapEvent,"[filemanager]").on(tapEvent,"[filemanager]",function(){if(0<$(this).find("[fileremove]:hover, [filedelete]:hover").length)return!1;t=lscache.get("clientmanagerdir")||!1,i=this,a&&a!=$(i).attr("filemanager")?(a=$(i).attr("filemanager")||0,getAjaxHtml("filemanager/files_get",{directory:t,filetypes:o[a]||a,client:1},function(e){$("#clientFileManager").find("#clientFilemanagerContentFiles").html(e)})):a=$(i).attr("filemanager")||0,0!=$("#clientFileManager").hasClass("visible")&&0!=$("#clientFileManager").length||(t&&!l&&(getAjaxHtml("filemanager/files_get",{directory:t,filetypes:o[a]||a,client:1},function(e){$("#clientFileManager").find("#clientFilemanagerContentFiles").html(e)}),getAjaxHtml("filemanager/dirs_get",{current_dir:t},function(e){$("#clientFileManager").find("#clientFilemanagerDirs").html(e)}),l=!0,null!=r.onOpenFilemanager)&&"function"==typeof r.onOpenFilemanager&&r.onOpenFilemanager(i),$("#clientFileManager").addClass("visible"))}),$("body").off(tapEvent,"[fileremove], [filedelete]").on(tapEvent,"[fileremove], [filedelete]",function(e){var t=$(this).closest(".file");ext=$(t).find("[filemanager]").attr("filemanager"),noneImg="none.png",/images|jpg|png|jpeg|ico|bmp/.test(ext)&&(noneImg="none_img.png"),$(this)[0].hasAttribute("fileremove")?($(t).addClass("empty"),$(t).find("[filename]").text(""),$(t).find("[fileimage]").children("img").attr("src","./public/images/"+noneImg),$(t).find("[filesrc]").val(""),null!=r.onRemoveFile&&"function"==typeof r.onRemoveFile&&r.onRemoveFile(t)):$(this)[0].hasAttribute("filedelete")&&($(t).remove(),null!=r.onDeleteFile)&&"function"==typeof r.onDeleteFile&&r.onDeleteFile()}),getAjaxHtml("filemanager/dirs_get",{current_dir:t},function(e){$("#clientFileManager").find("#clientFilemanagerDirs").html(e)}),$("#clientFileManager").find("#clientFilemanagerDirs").off(tapEvent,"[directory]:not(.disabled):not(.active)").on(tapEvent,"[directory]:not(.disabled):not(.active)",function(){var e=$(this).attr("directory");lscache.set("clientmanagerdir",e),$("#clientFileManager").find("#clientFilemanagerDirs").find("[directory]").removeClass("active"),$(this).addClass("active"),$("#clientFileManager").find("#clientFilemanagerContentFiles").addClass(" clientfilemanager__files_loading"),console.log("before"),getAjaxHtml("filemanager/files_get",{directory:e,filetypes:o[a]||a,client:1},function(e,t){console.log("after",t),$("#clientFileManager").find("#clientFilemanagerContentFiles").html(e),$("#clientFileManager").find("#clientFilemanagerContentFiles").removeClass("clientfilemanager__files_loading")})}),$("#clientFileManager").find("#clientFilemanagerContentFiles").off(tapEvent,".image").on(tapEvent,".image",function(){var e=$(this).closest(".clientfilemanager__file"),t=$(e).attr("dirfile"),e=$(e).attr("namefile"),n=$(this).find("img").attr("src");$(i).closest(".file").removeClass("empty"),$(i).closest(".file").find("[filesrc]").prop("value",t),$(i).closest(".file").find("[fileimage]").children("img").attr("src",n),$(i).closest(".file").find("[filename]").text(e),$("#clientFileManager").removeClass("visible"),null!=r.onChooseFile&&"function"==typeof r.onChooseFile?r.onChooseFile(i):$(i).addClass("changed")}),$("body").on(tapEvent,function(){0==$(s.join(":hover, ")+":hover").length&&$("#clientFileManager").hasClass("visible")&&$("#clientFileManager").removeClass("visible")}),$("#clientFileManager").on("mouseenter",function(){disableScroll()}),$("#clientFileManager").on("mouseleave",function(){enableScroll()})},notify=function(e,t,n){icon="fa fa-info","success"==(t=t||"success")?icon="fa fa-check-circle":"error"==t?icon="fa fa-exclamation-triangle":"info"==t&&(icon="fa fa-info-circle"),$.notify.addStyle("ddr",{html:'<div><i class="'+icon+'"></i><span data-notify-text/></div>'}),$.notify(e,{clickToHide:!0,autoHide:!0,autoHideDelay:n?1e3*n:5e3,arrowShow:!1,arrowSize:15,position:"top right",style:"ddr",className:t,showAnimation:"fadeIn",showDuration:200,hideAnimation:"fadeOut",hideDuration:100,gap:2})};